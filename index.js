require("dotenv").config();let fs=require("fs"),path=require("path"),{Client,Collection,Intents}=require("discord.js"),{GUILDID,TOKEN}=require("./config.json"),moment=require("moment-timezone"),nodeoutlook=require("nodejs-nodemailer-outlook"),bot=(fs.existsSync("./logs/log.ADM")||fs.writeFileSync("./logs/log.ADM",""),fs.existsSync("./logs/serverlog.ADM")||fs.writeFileSync("./logs/serverlog.ADM",""),new Client({intents:[Intents.FLAGS.GUILDS,Intents.FLAGS.GUILD_MESSAGES,Intents.FLAGS.GUILD_MEMBERS]})),servCheck=GUILDID,commandsPath=(bot.commands=new Collection,path.join(__dirname,"commands")),commandFiles=fs.readdirSync(commandsPath).filter(e=>e.endsWith(".js"));for(let e of commandFiles){let o=path.join(commandsPath,e);try{let e=require(o);e&&e.data&&e.data.name?bot.commands.set(e.data.name,e):console.warn("No commands detected in file: "+o)}catch(e){console.error(`Error loading command file ${o}:`,e)}}bot.on("interactionCreate",async o=>{if(o.isCommand()){var e=bot.commands.get(o.commandName);if(e)try{await e.execute(o)}catch(e){console.error(e),await o.reply({content:"There was an error while executing this command!",ephemeral:!0})}}}),bot.on("messageCreate",async e=>{var o;e.guild&&e.author&&e.member&&(e.author.bot||(o=e.guild.id,servCheck==o&&(o=e.guild.roles.cache.find(e=>"Admin"===e.name),e=e.guild.roles.everyone,o)&&e&&(o.id,e.id)))}),bot.login(TOKEN).catch(e=>{console.log(e)}),bot.on("ready",()=>{console.info(`Logged in as ${bot.user.tag}!`),console.log("KILLFEED IS ACTIVE!")}),bot.on("error",e=>{console.log(e)});